---
import Layout from "../layouts/Layout.astro";
import { ColonyCanvas } from "../components/flow/ColonyCanvas";
---

<Layout title="Ant Colony | Envelope System">
  <div class="h-screen w-screen flex flex-col overflow-hidden">
    <!-- Header -->
    <header class="flex-none px-6 py-4 border-b border-[#1e293b] bg-[#0f0f14]">
      <div class="flex items-center justify-between">
        <div class="flex items-center gap-4">
          <h1 class="text-xl font-semibold text-white flex items-center gap-2">
            <span class="text-2xl">ğŸœ</span>
            Ant Colony
          </h1>
          <span class="text-xs text-slate-500 px-2 py-1 rounded bg-slate-500/10 border border-slate-500/20">
            TypeQL â†’ JSON â†’ ReactFlow
          </span>
        </div>

        <nav class="flex items-center gap-4">
          <a href="/" class="text-sm text-slate-400 hover:text-white transition-colors">
            â† Back to Main
          </a>
          <a href="/envelopes" class="text-sm text-slate-400 hover:text-white transition-colors">
            Envelopes Only
          </a>
        </nav>
      </div>
    </header>

    <!-- Main canvas -->
    <main class="flex-1 relative">
      <ColonyCanvas client:load />
    </main>

    <!-- Footer -->
    <footer class="flex-none px-6 py-2 border-t border-[#1e293b] bg-[#0f0f14]">
      <div class="flex items-center justify-between text-[10px] text-slate-500">
        <div class="flex items-center gap-4">
          <span>The Colony Loop: L1â†’L2â†’L3â†’L4â†’L5â†’L6â†’L1</span>
          <span class="text-slate-600">|</span>
          <span>Pheromone decay: trail 5%, alarm 20%</span>
        </div>
        <div class="flex items-center gap-2">
          <span class="w-2 h-2 rounded-full bg-green-500 animate-pulse"></span>
          <span>TypeDB Inference Patterns</span>
        </div>
      </div>
    </footer>
  </div>
</Layout>

<style is:global>
  /* ReactFlow style overrides for dark theme */
  .react-flow__attribution {
    display: none !important;
  }

  .react-flow__panel {
    margin: 16px;
  }

  /* Custom animation for nodes */
  @keyframes pulse-subtle {
    0%, 100% {
      box-shadow: 0 0 0 0 rgba(34, 197, 94, 0);
    }
    50% {
      box-shadow: 0 0 0 4px rgba(34, 197, 94, 0.1);
    }
  }

  .animate-pulse-subtle {
    animation: pulse-subtle 2s ease-in-out infinite;
  }

  /* Edge label positioning */
  .react-flow__edge-textwrapper {
    pointer-events: none;
  }
</style>
